% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gwas_data_preparation.R
\name{gwas_data_preparation}
\alias{gwas_data_preparation}
\title{Cleaning GWAS summary data for colocalization}
\usage{
gwas_data_preparation(
  pheno_name,
  SNP_data_create_above,
  gwas_data_folder,
  gwas_data_suffix,
  gwas_allele_input,
  gwas_data_type,
  gwas_sdy_input = NULL,
  gwas_s_input = NULL,
  gwas_beta_input,
  save_folder
)
}
\arguments{
\item{pheno_name}{Character string or vector. The name(s) of the phenotype(s) to process. Can be comma-separated.}

\item{SNP_data_create_above}{Character string. File path to the SNP mapping data.
This specifically refers to the \strong{"SNP_data_for_coloc.csv"} file generated by the \code{nominated_gene_extract} function.}

\item{gwas_data_folder}{Character string. Path to the directory containing raw GWAS summary files.}

\item{gwas_data_suffix}{Character string. The file suffix for the raw GWAS summary statistics (e.g., ".txt", ".summary").
In multi-phenotype analysis, all files must share the same suffix.
The function expects filenames to strictly follow the format: \code{paste0(pheno, suffix)}.
\strong{Note:} The input GWAS summary statistics must contain \code{SNP}, \code{CHR}, and \code{BP} columns.
Additional columns are required depending on input parameters; please refer to the \strong{Details} section.
Column names must be strictly matched, though column order does not matter.}

\item{gwas_allele_input}{Logical. Whether to include allele columns (A1, A2) for strand alignment.}

\item{gwas_data_type}{Character string. One of "quant" (quantitative) or "cc" (case-control).}

\item{gwas_sdy_input}{Logical (optional). Required if \code{gwas_data_type = "quant"}. Whether the phenotype standard deviation (sdY) is available/provided in later steps.}

\item{gwas_s_input}{Logical (optional). Required if \code{gwas_data_type = "cc"}. Whether the proportion of cases (s) is provided.}

\item{gwas_beta_input}{Logical. Whether the GWAS summary data contains Beta and Standard Error columns.}

\item{save_folder}{Character string. Path to the output directory.}
}
\value{
None. The function saves processed files to the \code{save_folder}.
}
\description{
This function prepares GWAS summary statistics for subsequent colocalization analyses.
Upon execution, it extracts variants from the full GWAS summary statistics located within flanking regions (Â±500KB) centered on each nominated SNP defined in \code{SNP_data}.
The processed data is saved as individual text files in the \code{save_folder/${pheno}} directory, named after the specific causal SNP (e.g., \code{rs12345.txt}).

Please ensure that the gphysical positions in the input \code{SNP_data_create_above} and the raw GWAS summary statistics are aligned to the \strong{same reference genome build} (e.g., both hg19 or both hg38) to ensure accurate mapping.
}
\details{
The input GWAS summary data must contain at least: \strong{SNP, CHR, BP}.

\strong{For Quantitative Traits (\code{gwas_data_type = "quant"}):}
\itemize{
\item \strong{With sdY (Phenotype Standard Deviation), Beta, SE:} Requires \code{BETA}, \code{SE}.
\item \strong{With sdY, without Beta/SE:} Requires \code{P}, \code{MAF}.
\item \strong{Without sdY, with Beta/SE:} Requires \code{BETA}, \code{SE}, \code{MAF}.
\item \strong{Without sdY, without Beta/SE:} Requires \code{P}, \code{MAF}.
}

\strong{For Case-Control Traits (\code{gwas_data_type = "cc"}):}
\itemize{
\item \strong{With Beta/SE:} Requires \code{BETA}, \code{SE}.
\item \strong{Without Beta/SE:} Requires \code{P}, \code{MAF}.
}

\strong{Note on Harmonization:}
To ensure the effect alleles are aligned between GWAS and eQTL datasets, set \code{gwas_allele_input = TRUE}. This will further require \code{A1} (effect allele) and \code{A2} (other allele) columns.
}
